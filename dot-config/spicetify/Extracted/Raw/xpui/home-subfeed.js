"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[347],{80062:(e,s,n)=>{n.d(s,{HomeSubfeedWithRedirect:()=>U});var t=n(30758),o=n(97500),i=n.n(o),a=n(14343),r=n(67721),c=n(31417),h=n(6328),l=n(92202),m=n(15273),d=n(2950),p=n(76018),g=n(60836),u=n(52975),f=n(26921),x=n(93240),j=n(62411),C=n(44481),y=n(52439),A=n(11472),S=n(6683),_=n(68461),R=n(38501),b=n(95175),N=n(21549),w=n(33234),k=n(5062),v=n(86070);const M=(0,t.memo)((({cardCount:e})=>(0,v.jsx)("section",{children:(0,v.jsx)("div",{className:i()(k.A.home,k.A.homepage),children:(0,v.jsx)("div",{className:i()(k.A.homepageContent,"contentSpacing"),children:(0,v.jsx)(g.f,{showAll:!0,cardCount:e,withTitle:!1})})})}))),I=({sectionURIs:e})=>{const s=(0,a.NC)(R.MX4),n=s?S.SF:S.J3,{data:o,error:h,loading:m,extensions:p}=(0,A.$o)({uris:e,timeZone:(0,S.Ff)(),sp_t:(0,b.v8)("sp_t")??"",sectionItemsLimit:n},{gcTime:S.gO,staleTime:S.jl}),g=(0,d.getRequestIdForImpressions)(p),{spec:u}=(0,N.r)(r.Y,{data:{identifier:"home",uri:"spotify:home:pinned",reason:g??""}}),f=(0,j.d4)((e=>e.session.user)),I=(0,t.useCallback)((()=>{const s=new URL("https://open.spotify.com/home");s.searchParams.set("facet","pinned-by"),s.searchParams.set("hpuris",e.map((e=>e.replace("spotify:section:",""))).join(",")),s.searchParams.set("hpname",f?.display_name??f?.id??""),(0,w.l)(s.toString()),(0,x.M8)(c.Ru.get("feedback.link-copied"))}),[e,f?.display_name,f?.id]);return m?(0,v.jsx)(M,{cardCount:10}):null!==h||"HomeSectionCollection"!==o?.homeSections.__typename?(0,v.jsx)(l.LoadingPage,{hasError:!0,errorMessage:c.Ru.get("error.generic")}):(0,v.jsxs)("section",{"data-testid":"home-pin-page",className:i()(k.A.home,s?k.A.homepageWithCarousels:k.A.homepage),children:[(0,v.jsx)("div",{className:i()(k.A.homePinButton,"contentSpacing"),children:(0,v.jsx)(C.$,{iconLeading:y.C,onClick:I,size:"small",children:"Share your home"})}),(0,v.jsx)("div",{className:i()(k.A.homepageContent,"contentSpacing"),children:o.homeSections.sections.map(((e,s)=>"HomeSection"!==e.__typename?null:(0,v.jsx)(_.Q,{section:e,index:s,spec:u,greeting:null},`${s}-${e.uri}`)))})]})};var P=n(25187),$=n(92501),L=n(72700),H=n(2983);const D=(0,t.memo)((({cardCount:e})=>(0,v.jsxs)("div",{className:i()(k.A.homepageContent,"contentSpacing"),children:[(0,v.jsx)(h.y,{withTitle:!1}),(0,v.jsx)(g.f,{showAll:!0,cardCount:e,withTitle:!1})]}))),T=()=>{const e=(0,f.f)(),s=(0,a.NC)(R.MX4),n=(0,a.NC)(R.k4Y),{data:o,loading:h,error:g,extensions:x}=(0,L.f)(),j=(0,t.useRef)(null);(0,m.b)(j);const{spec:C}=(0,N.r)(r.Y,{data:{identifier:"home",uri:`spotify:home?facet=${e}`,reason:(0,d.getRequestIdForImpressions)(x)??""}}),y=o?.home;if(h)return(0,v.jsx)("section",{"data-testid":"home-subfeed-page",className:i()(k.A.home,s?k.A.homepageWithCarousels:k.A.homepage),children:(0,v.jsx)(D,{cardCount:50})});if(null!==g)return(0,v.jsx)(l.LoadingPage,{hasError:!0,errorMessage:c.Ru.get("error.generic")});if("HomeResponsePayload"!==y?.__typename)return(0,v.jsx)(l.LoadingPage,{hasError:!0,errorMessage:c.Ru.get("error.generic")});const A=y.sectionContainer.sections.items;return 0===A.length?(0,v.jsx)(l.LoadingPage,{hasError:!0,errorMessage:c.Ru.get("error.generic")}):("HomeShortsSectionData"!==A[0]?.data?.__typename&&(e=>s=>"HomeShortsSectionData"===s.data?.__typename||"spotify:section:0JQ5DAnM3wGh0gz1MXnu3N"===s.uri&&"podcasts-chip"===e||("spotify:section:0JQ5DAJvCyzyxqjq31tlEs"===s.uri||"spotify:section:0JQ5DAnM3wGh0gz1MXnucs"===s.uri)&&e===u.e)(e)(A[0])&&(y.sectionContainer.sections.items[0]={...A[0],data:{...A[0].data,__typename:"HomeShortsSectionData"}}),(0,v.jsx)("section",{ref:j,"data-testid":"home-subfeed-page",className:i()(k.A.home,s?k.A.homepageWithCarousels:k.A.homepage),children:(0,v.jsx)("div",{className:i()(k.A.homepageContent,"contentSpacing"),children:(0,v.jsx)(p.g,{container:y.sectionContainer,greeting:null,spec:C,enableFeedBaseline:n})})}))},U=()=>{const e=(0,f.f)(),{shelfURIs:s}=(0,P.T)(),n=(0,$.k)();if((0,a.NC)(R._Ie)){if("pinned-by"===e&&n){const e=n?.uris;return e.length?(0,v.jsx)(I,{sectionURIs:e}):(0,v.jsx)(H.$,{to:"/"})}if("pinned"===e){const e=s;return e.length?(0,v.jsx)(I,{sectionURIs:e}):(0,v.jsx)(H.$,{to:"/"})}}return e?(0,v.jsx)(T,{}):(0,v.jsx)(H.$,{to:"/"})}},92501:(e,s,n)=>{n.d(s,{k:()=>o});var t=n(85387);const o=()=>{const e=(0,t.zy)(),s=new URLSearchParams(e.search);if(!s.has("hpuris"))return null;const n=(s.get("hpuris")||"").split(",").map((e=>`spotify:section:${e}`));return{name:s.get("hpname")??"Shared",uris:n}}}}]);
//# sourceMappingURL=home-subfeed.js.map