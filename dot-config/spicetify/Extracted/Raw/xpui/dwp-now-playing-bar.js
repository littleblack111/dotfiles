"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[3322],{29095:(e,t,n)=>{n.d(t,{n:()=>o});var i=n(93523),a=n(99701),s=n(86070);const o=({icon:e,activeIcon:t,label:n,isActive:o,...r})=>(0,s.jsx)(a.Zp,{label:n,children:(0,s.jsx)(i.H,{"aria-label":`${n}, ${o?"selected":"unselected"}, button`,"aria-pressed":o,semanticColor:o?"textBrightAccent":"textSubdued",iconOnly:o?t:e,"aria-haspopup":"menu",size:"small",...r})})},70200:(e,t,n)=>{n.d(t,{t:()=>y});var i=n(62411),a=n(59892),s=n(78878),o=n(31417),r=n(29095),c=n(76612),l=n(2274),d=n(84859),u=n(75830),m=n(30758),g=n(10994),v=n(12864),p=n(44672),h=n(86070);const b=(0,m.memo)((function({onFeedbackReasonSelect:e}){const t=new Map([["not_relevant",o.Ru.get("ad-formats.ad-feedback.dislike.not-relevant")],["too_often",o.Ru.get("ad-formats.ad-feedback.dislike.too-often")],["unpleasant",o.Ru.get("ad-formats.ad-feedback.dislike.unpleasant-content")],["offensive",o.Ru.get("ad-formats.ad-feedback.dislike.offensive-content")],["do_not_like",o.Ru.get("ad-formats.ad-feedback.dislike.do-not-like")]]);return(0,h.jsx)(p.pZ,{value:"dislike-ad",children:(0,h.jsx)(g.W,{children:Array.from(t).map((([t,n])=>(0,h.jsx)(p.pZ,{value:n,children:(0,h.jsx)(v.D,{role:"menuitem","aria-label":n,onClick:()=>e(t,n),children:n})},t)))})})})),y=({item:e,isDisabled:t})=>{const n=(0,i.wA)(),{logAdFeedback:m}=(0,c.L)(e),g=(0,i.d4)((t=>(0,d.N)(t,e.id)));return(0,h.jsx)(u.b,{menu:(0,h.jsx)(b,{onFeedbackReasonSelect:(t,i)=>{e.id&&(n((0,l.NI)({adId:e.id,reason:i})),m(`dislike_${t}`))}}),children:(0,h.jsx)(r.n,{item:e,icon:a.P,activeIcon:s.X,label:o.Ru.get("ad-formats.ad-feedback.dislike"),isActive:g,"data-testid":"button-dislike-ad",onClick:()=>{if(e.id){if(g)return n((0,l.vA)({adId:e.id})),void m("cancel_dislike");n((0,l.NI)({adId:e.id})),m("dislike_menu")}},disabled:t})})}},51642:(e,t,n)=>{n.d(t,{T:()=>y});var i=n(62411),a=n(53907),s=n(62373),o=n(31417),r=n(29095),c=n(76612),l=n(2274),d=n(84859),u=n(75830),m=n(30758),g=n(10994),v=n(12864),p=n(44672),h=n(86070);const b=(0,m.memo)((function({onFeedbackReasonSelect:e}){const t=new Map([["relevant",o.Ru.get("ad-formats.ad-feedback.like.relevant")],["interested_in_brand",o.Ru.get("ad-formats.ad-feedback.like.interested-in-brand")],["interested_in_product",o.Ru.get("ad-formats.ad-feedback.like.interested-in-product")],["enjoyable",o.Ru.get("ad-formats.ad-feedback.like.enjoyable-content")],["discovered_new",o.Ru.get("ad-formats.ad-feedback.like.discovered-new")]]);return(0,h.jsx)(p.pZ,{value:"like-ad",children:(0,h.jsx)(g.W,{children:Array.from(t).map((([t,n])=>(0,h.jsx)(p.pZ,{value:n,children:(0,h.jsx)(v.D,{role:"menuitem","aria-label":n,onClick:()=>e(t,n),children:n})},t)))})})})),y=({item:e,isDisabled:t})=>{const n=(0,i.wA)(),{logAdFeedback:m}=(0,c.L)(e),g=(0,i.d4)((t=>(0,d.T)(t,e.id)));return(0,h.jsx)(u.b,{menu:(0,h.jsx)(b,{onFeedbackReasonSelect:(t,i)=>{e.id&&(n((0,l.F$)({adId:e.id,reason:i})),m(`like_${t}`))}}),children:(0,h.jsx)(r.n,{item:e,icon:a.G,activeIcon:s.q,label:o.Ru.get("ad-formats.ad-feedback.like"),isActive:g,"data-testid":"button-like-ad",onClick:()=>{if(e.id){if(g)return n((0,l.D$)({adId:e.id})),void m("cancel_like");n((0,l.F$)({adId:e.id})),m("like_menu")}},disabled:t})})}},64143:(e,t,n)=>{n.d(t,{O:()=>d});var i=n(93523),a=n(8518),s=n(31417),o=n(99701),r=n(98712),c=n(51354),l=n(86070);const d=({isDisliked:e=!1,onClick:t=(()=>{}),className:n,size:d="medium",semanticColor:u="textSubdued",label:m=s.Ru.get("playback-control.ban")})=>{const g=(0,c.y)();return(0,l.jsx)(o.Zp,{label:m,children:(0,l.jsx)(i.H,{role:"switch","aria-label":m,"aria-checked":e,className:n,onClick:t,iconOnly:a.P,semanticColor:u,size:g===r.E.MEDIUM?d:"small"})})}},83647:(e,t,n)=>{n.d(t,{z:()=>h});var i=n(30758),a=n(97500),s=n.n(a),o=n(39498),r=n(93523),c=n(45415),l=n(31417);const d="MRzne1iuLfbh7KEwhHOk";var u=n(86070);function m({onClick:e}){return(0,u.jsx)(r.H,{size:"small",onClick:e,iconOnly:c.M,"aria-label":l.Ru.get("close"),className:d})}const g="dixACKl18S755OnSdpna",v="IPdLO850RGC7isV9QxWB",p="S7PfnpeKtq9MCSrMhifz",h=(0,i.forwardRef)((({onClose:e=(()=>{}),children:t,shouldCloseOnEscapePress:n=!0,colorSet:a="encore-announcement-set",maxWidth:r=180,header:c},l)=>((0,i.useEffect)((()=>{const t=t=>{n&&"Escape"===t.key&&e()};return window.addEventListener("keydown",t,!0),()=>{window.removeEventListener("keydown",t,!0)}}),[n,e]),(0,u.jsxs)("div",{ref:l,className:s()(a,g,{[v]:!!c}),style:{maxWidth:`${r}px`},children:[!!c&&(0,u.jsxs)("div",{className:p,children:[c," ",(0,u.jsx)(m,{onClick:e})]}),t,c?null:(0,u.jsx)(m,{onClick:e}),(0,u.jsx)(o.i,{})]}))))},11600:(e,t,n)=>{n.d(t,{f:()=>m});var i=n(30758),a=n(97500),s=n.n(a),o=n(93523),r=n(99701);const c="main-genericButton-button",l="main-genericButton-buttonActive",d="main-genericButton-buttonActiveDot";var u=n(86070);const m=(0,i.forwardRef)(((e,t)=>{const n=e.isActive??!1,i=s()(c,{[l]:n||e.isActiveNoIndicator,[d]:n},e.className);return(0,u.jsx)(r.Zp,{label:e.label,children:(0,u.jsx)(o.H,{ref:t,style:e.style,"aria-label":e.label,size:"small",className:i,disabled:e.disabled,iconOnly:e.icon,onClick:e.onToggle,"data-testid":e.testId,"data-active":n.toString(),"aria-pressed":n,"data-restore-focus-key":e.restoreFocusKey})})}))},67787:(e,t,n)=>{n.d(t,{z:()=>a});var i=n(24653);const a=()=>{const{togglePanel:e,isActive:t}=(0,i.C)();return{isPickerOpen:t,triggerRef:{current:null},toggleDevicePicker(t){e(t)}}}},42321:(e,t,n)=>{n.d(t,{NowPlayingBar:()=>Ca});var i=n(30758),a=n(97500),s=n.n(a),o=n(62411),r=n(94079),c=n(70243),l=n(422),d=n(44481),u=n(31417);const m="dz_h98rH9nZCwfPdnKgr",g="rAfV2jB_HMM9Xtr0Rqvn",v="XkXPpDRWozMF6G8_GlLQ";var p=n(86070);const h=i.memo((function(e){const{handleClick:t}=e,n=u.Ru.get("pta.bottom-bar.title"),i=u.Ru.get("fta.bottom-bar.subtitle"),a=u.Ru.get("fta.sign-up-free");return(0,p.jsxs)("div",{className:m,onClick:t,"data-testid":"signup-bar",children:[(0,p.jsxs)("div",{className:g,children:[(0,p.jsx)(l.E,{as:"p",variant:"bodySmallBold",children:n}),(0,p.jsx)(l.E,{as:"p",variant:"bodyMedium",dangerouslySetInnerHTML:{__html:i}})]}),(0,p.jsx)(d.$,{colorSet:"invertedLight",onClick:t,className:v,children:a})]})}));var b=n(91631),y=n(99410),f=n(10856),k=n(62868),x=n(67787),C=n(53542),N=n(62642),j=n(21549);const I="gqYYMz8DkhaT3e44LcHQ",S="VX33mI2V_jRA7hRBI9_0",w=({remoteDeviceName:e,remoteDeviceType:t,connectionStatus:n,omitConnectionStateText:i=!1})=>{const{spec:a,logger:s}=(0,j.r)(f.s,{}),{triggerRef:o,toggleDevicePicker:r,isPickerOpen:c}=(0,x.z)(),d=(0,C.$A)(t,n),m=n===N.zP.CONNECTED?u.Ru.get("web-player.connect.bar.connected-state",{device_name:e}):u.Ru.get("web-player.connect.bar.connecting-state",{device_name:e});return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(d,{size:"small",className:S,role:"presentation",semanticColor:"essentialBase"}),(0,p.jsx)(y.Y,{component:"button",onClick:()=>{const e=a.activeDeviceButtonFactory(),{interactionId:t}=s.logInteraction(c?e.hitUiHide():e.hitUiReveal()),n=c;r(t),n||(0,k.I)("DEVICE-PICKER")},ref:o,className:I,children:(0,p.jsx)(l.E,{variant:"bodySmallBold","aria-live":"polite",semanticColor:"textBase",children:i&&n===N.zP.CONNECTED?e:m})})]})},A="nQSM_BrSHJ4Cp3XSuLOF",T=()=>(0,p.jsxs)("svg",{width:"1",height:"16",viewBox:"0 0 1 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",role:"separator",className:A,children:[(0,p.jsx)("g",{id:"separator",clipPath:"url(#clip0_491_88335)",children:(0,p.jsx)("rect",{id:"Rectangle 111112858",width:"1",height:"16",rx:"0.5",fill:"var(--essential-base)"})}),(0,p.jsx)("defs",{children:(0,p.jsx)("clipPath",{id:"clip0_491_88335",children:(0,p.jsx)("rect",{width:"1",height:"16",fill:"white"})})})]});var P=n(45836),E=n(43013),R=n(79237),D=n(69693),L=n(41434);const _="main-connectBar-connectBar",B="main-connectBar-connected",O="main-connectBar-connecting",F=function(){const{isPlayingRemotely:e,connectionStatus:t,remoteDeviceName:n,remoteDeviceType:i}=(0,R.v)((e=>{const t=(0,E.V)(e);return{isPlayingRemotely:t.isPlayingRemotely,connectionStatus:t.connectionStatus,remoteDeviceName:t.remoteDevice?.name,remoteDeviceType:t.remoteDevice?.type}}),L.a),{currentSession:a}=(0,D.D)(),o=Boolean(a?.active),r=e&&n&&i;if(!r&&!o)return null;const c=t===N.zP.CONNECTED||o,l=t===N.zP.CONNECTING&&!o;return(0,p.jsxs)("div",{className:s()(_,{"encore-bright-accent-set":c,[B]:c,[O]:l}),children:[o&&(0,p.jsx)(P.K,{}),o&&r&&(0,p.jsx)(T,{}),r&&(0,p.jsx)(w,{connectionStatus:t,remoteDeviceName:n,remoteDeviceType:i,omitConnectionStateText:o})]})},M=()=>(0,p.jsx)(i.Suspense,{fallback:null,children:(0,p.jsx)(F,{})});var U=n(40638),H=n(14343),z=n(86996),V=n(14732),Q=n(98293),q=n(62435),K=n(74934),G=n(11600),Z=n(93629),Y=n(58685);const W=({className:e="",disabledClassName:t="",onClick:n})=>{const a=(0,K.lZ)(),r=(0,i.useContext)(q.s),c=(0,Y.o)((e=>e?.hasContext??!1)),l=(0,o.wA)(),d=!c,m=(0,i.useCallback)((async()=>{r?.current&&(n?.(!0),l((0,Q.f)()),(0,Z.X8)(r.current))}),[l,r,n]),g=s()(e,{[t]:d});return a?(0,p.jsx)(G.f,{onToggle:m,className:g,icon:V.L,label:u.Ru.get("npv.full-screen"),disabled:d,testId:"fullscreen-mode-button"}):null},X=(0,i.memo)(W);var $=n(52666),J=n(57969),ee=n(31233),te=n(24653);var ne=n(95631),ie=n(93523),ae=n(45415);const se="xP7v0EBcbJMj1xIJxywg",oe="zJU_lLLzQL6oKvMA0c5b",re=({onClose:e,onMouseEnter:t,onMouseLeave:n,onClick:i,impressionCallback:a,message:s})=>(0,p.jsxs)("div",{className:se,onMouseEnter:t,onMouseLeave:n,ref:a,onClick:i,children:[(0,p.jsx)(l.E,{id:"nudgeBody",as:"p",variant:"bodyMedium",semanticColor:"textBase",children:s}),(0,p.jsx)(ie.H,{iconOnly:ae.M,size:"small",semanticColor:"textBase",onClick:t=>{t.stopPropagation(),e?.()},"aria-label":u.Ru.get("close"),className:oe})]});var ce=n(11328),le=n(70427);const de=(e=ce.C)=>{const t=(0,o.Pj)(),{isActive:n}=e(),i=(0,le.h)();return document.hasFocus()&&!n&&!(({ui:e,ads:t},n)=>e.blockUserDialog.isOpen||e.connectDevicePicker.isOpen||e.deleteFolderDialog.isOpen||e.deletePlaylistDialog.isOpen||e.fullscreenMode.isOpen||e.improvedSignupPromptDialog.isOpen||e.keyboardShortcutsHelpModal.isOpen||e.leavePlaylistDialog.isOpen||e.loginToListenDialog.isOpen||e.offlineDeviceLimitReachedDialog.isOpen||e.playbackNotSupportedErrorDialog.isOpen||e.premiumDialog.isOpen||e.signupToListenDialog.isOpen||!0===t.billboard?.isOpen&&!t.billboard.isMinimized||!1===t.vto?.isHidden&&!1===t.vto?.isMinimized||n)(t.getState(),i.current.length>0)};var ue=n(48180);const me=e=>Boolean(e?.supportsDJNarration);var ge=n(78736),ve=n(85590),pe=n(82921),he=n(93758),be=n(87464),ye=n(87182),fe=n(90326),ke=n(37163),xe=n(16581),Ce=n(43329);const Ne="spotify:playlist:37i9dQZF1EYkqdzj48dyYq",je=e=>{const t=(0,i.useRef)(),n=(0,i.useRef)(),a=(0,i.useRef)(!1),s=(0,ye.z)(),o=(0,ve.e)(),r=(0,pe.Z)(),c=(0,H.NC)(Ce.vF),{spec:l,logger:d}=(0,j.r)(ue.w,{}),m=(0,i.useRef)(null),g=(0,i.useCallback)((()=>{d.logInteraction(l.djVoiceUnsupportedNudgeFactory().closeButtonFactory().hitUiHide())}),[l,d]),v=(0,i.useCallback)((e=>{e&&m.current!==e&&d.logImpression(l.djVoiceUnsupportedNudgeFactory().impression()),m.current=e}),[l,d]),p=(0,i.useCallback)((()=>{const e=s.getState();if(c){const t=r.getActiveDevice();return!(e=>e?.isLocal??!1)(t)&&(0,xe.yc)(e,Ne)!==ke.i.NOT_ACTIVE&&!me(t??void 0)}const t=o.getState();return!(e=>e?.connectionStatus===N.zP.NOT_CONNECTED)(t)&&(0,xe.yc)(e,Ne)!==ke.i.NOT_ACTIVE&&!me(t?.activeDevice??void 0)}),[s,c,o,r]),h=(0,i.useCallback)((()=>{p()&&e({nudgeType:"message-only-nudge",message:u.Ru.get("web-player.connect.nudge.dj-voice-unavailable"),onClose:g,impressionCallback:v})}),[e,p,g,v]),b=(0,i.useCallback)((e=>{e.data.action===be.Ik.PLAY&&(a.current=!0)}),[]);(0,fe.p)(be.gd.ACTION,b);const y=(0,i.useCallback)((e=>{a.current&&(0,xe.uW)(e.data)===ke.i.PLAYING&&(t.current=e.data?.context.uri,h(),t.current=void 0,a.current=!1)}),[h]);(0,fe.p)(be.gd.UPDATE,y);const f=(0,i.useCallback)((e=>{const t=e.data?.activeDevice;t&&!t.isLocal&&n.current!==t.connectStateId&&h(),n.current=t?.connectStateId}),[h]);(0,he.W)(ge.P.UPDATE,f)};var Ie=n(92443);const Se=e=>{switch(e.type){case N.bq.AUDIO_DONGLE:case N.bq.AVR:case N.bq.CAST_AUDIO:case N.bq.CAST_VIDEO:case N.bq.GAME_CONSOLE:case N.bq.SPEAKER:case N.bq.STB:case N.bq.TV:return!0;default:return!1}},we=e=>!e||!(e.terminalType===Ie.FI.HEADPHONES||e.terminalType===Ie.FI.SPEAKERS&&(e.transportType===Ie.Yg.BLUETOOTH||e.transportType===Ie.Yg.USB));var Ae=n(25182),Te=n(25016),Pe=n(62021);const Ee=new Date(0).toISOString(),Re=["shift+alt+f10"],De=e=>{const t=(0,i.useRef)(),n=(0,i.useRef)(!1),a=(0,i.useRef)(!1),s=(0,o.Pj)(),r=(0,ye.z)(),c=(0,ve.e)(),l=(0,pe.Z)(),d=(0,Te.V)(),[m,g]=(0,Pe.x)("connect-nudge-triggered-at",Ee),v=(0,i.useRef)(null),{spec:p,logger:h}=(0,j.r)(ue.w,{}),b=(0,H.NC)(Ce.vF),y=(0,i.useCallback)((()=>{h.logInteraction(p.connectFromDevicePickerNudgeFactory().hitNoAction())}),[p,h]),f=(0,i.useCallback)((()=>{h.logInteraction(p.connectFromDevicePickerNudgeFactory().closeButtonFactory().hitUiHide())}),[p,h]),k=(0,i.useCallback)((e=>{e&&v.current!==e&&h.logImpression(p.connectFromDevicePickerNudgeFactory().impression()),v.current=e}),[p,h]);(0,Ae.f)(Re,(async()=>{const{platform:{isDeveloperMode:e}}=s.getState();if(e){const e=new Date;e.setHours(e.getHours()-8),g(e.toISOString())}}));const x=(0,i.useCallback)((()=>{const e=r.getState(),t=c.getState(),n=l.getActiveDevice(),i=l.getDevices(),a=d.getDefaultDevice(),s=new Date(m);s.setHours(s.getHours()+8);const o=s<=new Date;return b?o&&(e=>e?.isLocal??!1)(n)&&!(0,xe.A3)(e)&&(e=>e.some((e=>e.isLocalNetwork&&!e.isDisabled&&Se(e))))(i)&&we(a):o&&(e=>e?.connectionStatus===N.zP.NOT_CONNECTED)(t)&&!(0,xe.A3)(e)&&(e=>!!e?.devices.length&&e.devices.some((e=>e.isLocalNetwork&&!e.isDisabled&&Se(e))))(t)&&we(a)}),[r,c,d,m,b,l]),C=(0,i.useCallback)((()=>{if(x()){e({nudgeType:"message-only-nudge",message:u.Ru.get("web-player.connect.nudge.listen-to-speaker"),impressionCallback:k,onClick:y,onClose:f});const t=(new Date).toISOString();g(t)}}),[e,x,g,y,f,k]),I=(0,i.useCallback)((e=>{e.data.action===be.Ik.PLAY?n.current=!0:e.data.action===be.Ik.RESUME&&(a.current=!0)}),[]);(0,fe.p)(be.gd.ACTION,I);const S=(0,i.useCallback)((e=>{n.current&&(0,xe.uW)(e.data)===ke.i.PLAYING?(t.current=e.data?.context.uri,C(),t.current=void 0,n.current=!1):a.current&&!1===e.data?.isPaused&&(t.current=e.data?.context.uri,C(),t.current=void 0,a.current=!1)}),[C]);(0,fe.p)(be.gd.UPDATE,S)};var Le=n(8808),_e=n(22726),Be=n(29195),Oe=n(71681),Fe=n(52266),Me=n(10565),Ue=n(90754),He=n(6530);const ze=e=>{const t=(0,Me.d)(),{getSessionInfo:n,joinSession:a,currentSession:s}=(0,D.D)(),o=(0,Be.vh)(),r=(0,Oe.b)(),c=(0,Ie.lS)(r),l=(0,i.useRef)(new Set),d=(0,i.useCallback)((async(e,t)=>{l.current.add(t);const n="IN_PERSON",i=He.JO.NEARBY_DIALOG;try{const s=await a(e,i,n);s&&o.send((0,Le.X)({session_id:t,join_type:i,join_url:s.joinSessionUri,participation_mode:n}))}catch(e){e instanceof Error&&o.send((0,Le.X)({session_id:t,error_category:e.name,error_data:e.message}))}}),[o,a]),m=(0,ye.z)(),g=(0,i.useCallback)((()=>(0,xe.uW)(m.getState())!==ke.i.PLAYING),[m]),v=(0,i.useCallback)((async(t,{sessionMembers:n,sessionOwnerId:i,sessionId:a,isSessionOwner:s})=>{const o=n.find((e=>e.id===i));if(!o||s)return;const r=n.map((e=>({uri:(0,_e.Qjr)(e.username).toURI(),displayName:e.displayName,username:e.username,images:e.imageUrl?[{url:e.imageUrl}]:[]})));g()&&e({nudgeType:"join-listening-session-nudge",title:u.Ru.get("web-player.social-connect.broadcasting.join-listening-session-nudge-title",{host:o.displayName,device:t.title}),message:u.Ru.get("web-player.social-connect.broadcasting.join-listening-session-nudge-text"),onClose:()=>{},onActionButtonClick:()=>{d(t.token,a)},users:r})}),[g,d,e]);(0,Ue.c)(Fe.P.SCAN_UPDATE,(()=>{if(s?.active)return;const e=t.getLocalNetSessionDevices(),i=e?.devices.find((e=>e.isNew));i&&(async e=>{if(c)return;const i=await n(e.token);if(i){if(l.current.has(i.sessionId))return;const n=await t.getLocalNetSesssionDeviceVisibility(i.sessionId);n!==He.MS.UNSPECIFIED&&n!==He.MS.NOTIFY||v(e,i)}})(i)}))};var Ve=n(40339),Qe=n(53328),qe=n(8428),Ke=n(15779);const Ge=e=>{De(e),je(e),ze(e),(e=>{const{panelSend:t}=(0,Ve.AI)(qe.Z.DevicePicker,qe.Z.DevicePickerOverlay),[n,a]=(0,Pe.x)("session-broadcast-nudge-shown",[]),s=(0,i.useCallback)((e=>{const t=[...n,e];t.length>10&&t.shift(),a(t)}),[n,a]);(0,Ue.c)(Fe.P.BROADCAST_NUDGE,(({data:i})=>{const a=i.deviceId;i.broadcastStatus===Ke.ez.BROADCAST_ON&&a&&!n.includes(a)&&e({nudgeType:"session-is-being-broadcasted-nudge",message:u.Ru.get("web-player.social-connect.broadcasting.session-is-being-broadcasted-nudge-text"),onClose:()=>{},onActionButtonClick:()=>{t({type:Qe.$S.DEVICE_PICKER_BUTTON_CLICK})},onShow:()=>{s(a)}})}))})(e)},Ze=()=>{const e=(0,i.useRef)(),t=(0,i.useRef)(!1),n=(0,i.useRef)(!1),a=(0,o.wA)(),s=(0,o.d4)((e=>e.ui.connectNudge.isOpen)),r=(0,o.d4)((e=>e.ui.connectDevicePicker.isOpen)),c=(0,i.useCallback)((()=>{n.current&&(clearTimeout(e.current),n.current=!1),a((0,Q.Yp)())}),[a]),l=(0,i.useCallback)((()=>{n.current=!1,t.current||c()}),[c]),d=(0,i.useCallback)((()=>{e.current=window.setTimeout(l,8e3),a((0,Q.dK)()),n.current=!0}),[a,l]),u=(0,i.useCallback)((e=>{t.current=e,e||n.current||c()}),[c]);return(0,i.useEffect)((()=>{r&&c()}),[r,c]),(0,i.useMemo)((()=>({hideNudge:c,showNudge:d,setShouldKeepShowingNudge:u,isNudgeVisible:s})),[c,d,u,s])};var Ye=n(53974),We=n(68599);const Xe="uETBcNmdHUHF_YPLJfOx",$e="kb2DrVIixaicEzk6sEcP",Je="PmEpl43j3MvwvoqnnZ6A",et="zWPenObFu5ZjWvtk_qSb",tt=({onClose:e,onActionButtonClick:t,onMouseEnter:n,onMouseLeave:a,message:s,title:o,users:r})=>{const{spec:c,logger:m}=(0,j.r)(Ye.m,{});(0,i.useEffect)((()=>{m.logImpression(c.nudgeScanningTooltipFactory().impression())}),[m,c]);const g=(0,i.useCallback)((()=>{m.logInteraction(c.nudgeScanningTooltipFactory().closeButtonFactory().hitUiHide()),e?.()}),[m,e,c]),v=(0,i.useCallback)((()=>{m.logInteraction(c.nudgeScanningTooltipFactory().joinButtonFactory().hitJoinSocialListeningSession()),t()}),[m,t,c]);return(0,p.jsxs)("div",{className:Xe,onMouseEnter:n,onMouseLeave:a,children:[(0,p.jsxs)("div",{className:$e,children:[r.length>0&&(0,p.jsx)(We.g,{users:r}),(0,p.jsx)(l.E,{as:"p",variant:"bodyMediumBold",semanticColor:"textBase",className:Je,children:o}),(0,p.jsx)(ie.H,{iconOnly:ae.M,size:"small",semanticColor:"textBase",onClick:g,"aria-label":u.Ru.get("close")})]}),(0,p.jsx)(l.E,{id:"nudgeBody",as:"p",variant:"bodySmall",semanticColor:"textBase",children:s}),(0,p.jsx)("div",{className:et,children:(0,p.jsx)(d.$,{colorSet:"invertedLight",size:"small",onClick:v,children:u.Ru.get("web-player.social-connect.join-modal.button-primary")})})]})};var nt=n(91488);const it="_eXNo3nLWPbXuTHH7K08",at="VT_giL9ITyvqFuzZsmWk",st="m5mgkcoKawOAJIWj0JE7",ot=({onActionButtonClick:e,onMouseEnter:t,onMouseLeave:n,message:a,onShow:s})=>{const{spec:o,logger:r}=(0,j.r)(Ye.m,{});(0,i.useEffect)((()=>{s?.(),r.logImpression(o.nudgeBroadcastingTooltipFactory().impression())}),[r,s,o]);const c=(0,i.useCallback)((()=>{r.logInteraction(o.nudgeBroadcastingTooltipFactory().changeButtonFactory().hitUiReveal()),e?.()}),[r,e,o]);return(0,p.jsxs)("div",{className:it,onMouseEnter:t,onMouseLeave:n,children:[(0,p.jsx)(nt.h,{size:"medium",className:at}),(0,p.jsx)(l.E,{id:"nudgeBody",as:"p",variant:"bodySmall",semanticColor:"textBase",children:a}),(0,p.jsx)("div",{className:st,children:(0,p.jsx)(d.$,{colorSet:"invertedLight",size:"small",onClick:c,children:u.Ru.get("web-player.social-connect.broadcasting.session-is-being-broadcasted-nudge-button")})})]})},rt=({children:e,useNudgeTriggers:t=Ge,useToggleNudgeWithTimer:n=Ze,useCanShowNudge:a=de,disabled:s=!1})=>{const{showNudge:o,hideNudge:r,setShouldKeepShowingNudge:c,isNudgeVisible:l}=n(),[d,u]=(0,i.useState)(null),m=a();(0,i.useEffect)((()=>{l&&!m&&r()}),[m,r,l]),t((e=>!(l||!m)&&(u(e),o(),!0)));const g=(0,i.useCallback)((e=>{if(!e)return(0,p.jsx)(p.Fragment,{});const t=()=>{e?.onClose?.(),r()};if("join-listening-session-nudge"===e.nudgeType){const n=()=>{e.onActionButtonClick?.(),r()};return(0,p.jsx)(tt,{onMouseEnter:()=>c(!0),onMouseLeave:()=>c(!1),...e,onClose:t,onActionButtonClick:n})}if("session-is-being-broadcasted-nudge"===e.nudgeType){const n=()=>{e.onShow?.()};return(0,p.jsx)(ot,{onMouseEnter:()=>c(!0),onMouseLeave:()=>c(!1),...e,onClose:t,onShow:n})}return(0,p.jsx)(re,{onMouseEnter:()=>c(!0),onMouseLeave:()=>c(!1),...e,onClose:t})}),[r,c]);return(0,p.jsx)(ne.W,{maxWidth:"join-listening-session-nudge"===d?.nudgeType?450:void 0,placement:"top",visible:Boolean(d?.message)&&l&&!s,overlay:g(d),popperOptions:{modifiers:[{name:"preventOverflow",options:{rootBoundary:"viewport",altAxis:!0,padding:24,tether:!1}}]},onHide:()=>{},fadeOut:!0,useLazyMounting:!0,children:e})},ct=()=>{const{remoteDeviceType:e,remoteDeviceIsGroup:t,connectionStatus:n}=(0,R.v)((e=>{const t=(0,E.V)(e);return{remoteDeviceType:t.remoteDevice?.type,remoteDeviceIsGroup:t.remoteDevice?.isGroup,connectionStatus:t.connectionStatus}}),L.a),a=(0,J.g)(),{canTogglePanel:s,isActive:o,togglePanel:r}=(0,te.C)(),{spec:c,logger:l}=(0,j.r)($.p,{}),d=(0,i.useCallback)((()=>{const{interactionId:e}=l.logInteraction(function(e,t,n){return {interactionId:null,pageInstanceId:null};let i;return i=t===N.zP.CONNECTING?e.connectingButtonFactory():t===N.zP.CONNECTED?e.connectedButtonFactory():e.notConnectedButtonFactory(),n?i.hitUiHide():i.hitUiReveal()}(c,n,o));r(e)}),[n,r,o,c,l]),{currentDevice:m}=(0,ee.l)(),{isLocal:g}=m,v=(0,i.useMemo)((()=>(0,C.tf)(e,t,g?a:null)),[a,g,t,e]);return(0,p.jsx)(rt,{children:(0,p.jsx)(G.f,{isActive:o,disabled:!s,onToggle:d,label:u.Ru.get("playback-control.connect-picker"),icon:v})})};var lt=n(30003),dt=n(83647),ut=n(70196),mt=n(30536);const gt="A8ETvbaffbfWsxJDy_OW",vt="yQQ8ZWvoqRXw2oHD1OJR",pt=({children:e})=>(0,p.jsx)("div",{className:gt,children:e}),ht=({onHide:e})=>{const t=(0,Ve._Y)();return(0,p.jsxs)(pt,{children:[(0,p.jsx)(l.E,{variant:"bodyMedium",children:u.Ru.get("web-player.puffin.upsell.enhance-headphones")}),(0,p.jsxs)("div",{className:vt,children:[(0,p.jsx)(ie.H,{semanticColor:"textSubdued",onClick:e,condensedAll:!0,size:"small",children:u.Ru.get("web-player.puffin.upsell.enhance-headphones.cancel")}),(0,p.jsx)(d.$,{colorSet:"invertedLight",onClick:()=>{t(Qe.$S.PUFFIN_START_ACTIVATION),e()},size:"small",children:u.Ru.get("web-player.puffin.upsell.enhance-headphones.confirm")})]})]})};var bt=n(49885);const yt=()=>{const{deviceFilterState:{audioDevice:e}}=(0,bt.j)();if(!e)return null;const t=e.transportType===Ie.Yg.BLUETOOTH?e.name:u.Ru.get("web-player.puffin.wired-connection");return(0,p.jsx)(pt,{children:(0,p.jsx)(l.E,{variant:"bodyMedium",children:u.Ru.get("web-player.puffin.upsell.optimized-for",t)})})},ft=({hasDevice:e})=>(0,E.l)()?(0,p.jsx)(pt,{children:(0,p.jsx)(l.E,{variant:"bodyMedium",children:u.Ru.get("web-player.puffin.upsell.enhanced-listening")})}):e?(0,p.jsx)(pt,{children:(0,p.jsx)(l.E,{variant:"bodyMedium",children:u.Ru.get("web-player.puffin.upsell.enhanced-headphones")})}):(0,p.jsx)(pt,{children:(0,p.jsx)(l.E,{variant:"bodyMedium",children:u.Ru.get("web-player.puffin.upsell.lossless-listening")})});var kt=n(85907);const xt=({state:e,hasDevice:t,onHide:n})=>{switch(e){case"detection":return(0,p.jsx)(ht,{onHide:n});case"initial":return(0,p.jsx)(ft,{hasDevice:t});case"filters_applied":return(0,p.jsx)(yt,{});default:(0,kt.k)(e)}return null};var Ct=n(15645),Nt=n(23805);var jt=n(53957);const It=({children:e,onVisibilityChange:t})=>{const{isPuffinPanelActive:n}=(0,jt.c)(),[a,s]=(0,i.useState)("none"),{deviceFilterState:o,isMaybeHeadphoneDevice:r}=(0,bt.j)(),c=(0,i.useRef)(o.audioDevice),l=(0,Nt.N)().getSavedDevices().length>0,{incrementDismissCountForDevice:d,isDeviceDismissed:u}=(0,Ct.o)();(0,i.useEffect)((()=>{if(o.audioDevice&&c.current?.id!==o.audioDevice.id){if(c.current=o.audioDevice,n||o.audioDevice.terminalType!==Ie.FI.HEADPHONES)return;u||o.isOnboarded?(o.currentState.externalizationEnabled||o.currentState.specificEnabled)&&s("filters_applied"):s("detection")}}),[o,u,n,c]);const m=(0,i.useCallback)((()=>{s("none")}),[]),g=(0,i.useCallback)((()=>{null!==o.audioDevice&&d(),m()}),[o.audioDevice,m,d]);(0,i.useEffect)((()=>{if("detection"!==a){const e=setTimeout(m,5e3);return()=>clearTimeout(e)}return()=>{}}),[m,a]),(0,i.useEffect)((()=>{l||u||s("initial")}),[l,u,s]),(0,i.useEffect)((()=>{!n&&r||m()}),[m,n,r]);const v="none"!==a;return(0,i.useEffect)((()=>{t(v)}),[v,t]),(0,p.jsx)(ut.E,{isVisible:v,placement:"top-start",content:v?(0,p.jsx)(dt.z,{onClose:g,maxWidth:287,header:(0,p.jsx)(mt.s,{variant:"bodyMediumBold"}),children:(0,p.jsx)(xt,{state:a,hasDevice:r,onHide:g})}):null,children:e})};var St=n(35692);const wt=Qe.$S.PUFFIN_BUTTON_CLICK,At=Qe.$S.DEVICE_PICKER_BUTTON_CLICK,Tt=()=>{const{isPuffinPanelActive:e}=(0,St.c)(),{isActive:t,panelSend:n}=(0,Ve.AI)(qe.Z.DevicePicker,qe.Z.DevicePickerOverlay),[a,s]=(0,i.useState)(!1),o=(0,Ve.Ev)(wt),{remoteDeviceType:r,remoteDeviceisGroup:c}=(0,R.v)((e=>{const t=(0,E.V)(e);return{remoteDeviceType:t.remoteDevice?.type,remoteDeviceisGroup:t.remoteDevice?.isGroup}}),L.a),l=(0,J.g)(),d=l?.audioDevice.terminalType===Ie.FI.HEADPHONES,m=(()=>{const{deviceFilterState:e}=(0,bt.j)();return e.currentState.externalizationEnabled||e.currentState.specificEnabled})(),g=t||e,v=m||d,{currentDevice:h}=(0,ee.l)(),{isLocal:b}=h,y=(0,i.useMemo)((()=>m?lt.C:(0,C.tf)(r,c,b?l:null)),[l,m,c,r,b]);return(0,p.jsx)(rt,{disabled:a,children:(0,p.jsx)(It,{onVisibilityChange:s,children:(0,p.jsx)(G.f,{isActive:g,isActiveNoIndicator:v,onToggle:()=>{const e=t;n(At),e||(0,k.I)("DEVICE-PICKER")},label:u.Ru.get("playback-control.connect-picker"),icon:y,disabled:!o,restoreFocusKey:e?qe.Z.Puffin:qe.Z.DevicePicker})})})};var Pt=n(20916),Et=n(36061);const Rt=()=>{const{isAnonymous:e}=(0,o.d4)(Et.Ht),t=(0,Pt.v)();return e?null:t?(0,p.jsx)(i.Suspense,{fallback:null,children:(0,p.jsx)(Tt,{})}):(0,p.jsx)(ct,{})};var Dt=n(15071),Lt=n(90841),_t=n(1377),Bt=n(18893),Ot=n(38501);const Ft=i.memo((({onClick:e,className:t,isActive:n,isEnabled:i})=>{const a=i?u.Ru.get("web-player.lyrics.title"):u.Ru.get("web-player.lyrics.noLyrics1"),s=i?e:void 0;return(0,p.jsx)(G.f,{className:t,isActive:n,onToggle:s,disabled:!i,label:a,testId:"lyrics-button",icon:Dt.q})})),Mt=i.memo((e=>{const t=Boolean((0,Bt.J)().data?.hasLyrics);return(0,p.jsx)(Ft,{...e,isEnabled:t,isActive:!1})})),Ut=i.memo((e=>{const t=(0,Y.o)((e=>e?.item?.uri)),n=Boolean((0,_t.f)(t).hasLyrics);return(0,p.jsx)(Ft,{...e,isEnabled:n,isActive:!1})})),Ht=i.memo((e=>{const{isActive:t}=(0,Lt.$)(),{isAnonymous:n}=(0,o.d4)(Et.Ht),i=(0,H.NC)(Ot.khs),a=(0,Y.o)((e=>{if(e?.item?.uri&&(0,_e.U_m)(e?.item?.uri)){return!Boolean(e?.item?.metadata?.["segment.index"])}return!1}));return n||!a?null:t?(0,p.jsx)(Ft,{...e,isActive:!0,isEnabled:!0}):i?(0,p.jsx)(Mt,{...e}):(0,p.jsx)(Ut,{...e})}));var zt=n(66204);const Vt=({onClick:e,className:t})=>{const{toggleLyrics:n}=(0,zt.A)({onChange:e,referrer:"now_playing_bar"});return(0,p.jsx)(Ht,{onClick:n,className:t})};var Qt=n(90680),qt=n(29839),Kt=n(47756);const Gt=Qe.$S.NPV_BUTTON_CLICK,Zt=({onClick:e})=>{const{isActive:t,panelSend:n}=(0,Ve.AI)(qe.Z.NowPlayingView),i=(0,Ve.Ev)(Gt),{mode:a,setMode:s}=(0,qt.r)(),o=(0,H.NC)(Ot.ZDY),{item:r}=(0,Y.o)((e=>({item:e?.item})),((e,t)=>e.item?.uri===t.item?.uri)),c=!r||!i;return o?null:(0,p.jsx)(G.f,{isActive:t,disabled:c,onToggle:()=>{e?.(!t),n(Gt),a===Kt.YU.cinema&&s(Kt.YU.npv)},icon:Qt.d,label:u.Ru.get("web-player.now-playing-view.label"),testId:"control-button-npv",restoreFocusKey:qe.Z.NowPlayingView})};var Yt=n(85387),Wt=n(87786),Xt=n(2963),$t=n(6904),Jt=n(76123),en=n(20784),tn=n(15178);const nn=({uri:e,to:t,children:n,onDrop:a,onNavigate:s,className:r})=>{const[c,l]=(0,i.useState)(!1),d=(0,i.useRef)(null),u=(0,Yt.Zp)(),m=(0,o.wA)(),g=(0,en.f)(),v=(0,tn.g)(),h=(0,ye.z)(),b=function(e){const t=(0,_e.o_h)(e),n=(0,o.d4)(Et.F6);switch(t?.type){case _e.NQG.PLAYLIST:case _e.NQG.PLAYLIST_V2:{let e;if((0,_e.iwx)(t)&&(e=t.username),n&&e===n)return[Jt.Ay[_e.NQG.TRACK],Jt.Ay[_e.NQG.LOCAL],Jt.Ay[_e.NQG.ALBUM]];break}case _e.NQG.COLLECTION:return[Jt.Ay[_e.NQG.TRACK],Jt.Ay[_e.NQG.ALBUM],Jt.Ay[_e.NQG.ARTIST],Jt.Ay[_e.NQG.PLAYLIST],Jt.Ay[_e.NQG.PLAYLIST_V2],Jt.Ay[_e.NQG.SHOW]];case _e.NQG.QUEUE:return[Jt.Ay[_e.NQG.TRACK],Jt.Ay[_e.NQG.LOCAL],Jt.Ay[_e.NQG.EPISODE]];default:return[]}return[]}(e),y=!!b.length;return(0,i.useEffect)((()=>(c?d.current=window.setTimeout((()=>{(0,_e.U_m)(e)||(s?.(),u(t||(0,_e.o_h)(e).toURLPath(!0)))}),1e3):!c&&d.current&&clearTimeout(d.current),()=>{d.current&&clearTimeout(d.current)})),[c,e,t,s,u]),y?(0,p.jsx)($t.A,{types:b,onDrop:t=>{const n=(0,_e.o_h)(e),i=Array.from(t.dataTransfer.types).find((e=>b.includes(e))),s=i&&t.dataTransfer.getData(i),o=s&&s.split("\n")[0],r=(0,_e.o_h)(o);if(r&&n)switch(a?.(r.toURI()),n.type){case _e.NQG.PLAYLIST:case _e.NQG.PLAYLIST_V2:m((0,Xt.io)(e,[r.toURI()]));break;case _e.NQG.COLLECTION:(0,_e._Tv)(r)||(0,_e.ecE)(r)||(0,_e.U_m)(r)?g.add({uris:[r.toURI()]}):(0,_e.tbX)(r)?v.add([r.toURI()],{before:"start"}):(0,_e.WB1)(r)&&g.add({uris:[r.toURI()]});break;case _e.NQG.QUEUE:h.addToQueue([{uri:r.toURI(),uid:null}])}},onDragEnter:()=>{l(!0)},onDragLeave:()=>{l(!1)},className:r,children:n}):(0,p.jsx)("div",{children:n})};var an=n(89402);function sn({style:e,active:t,disabled:n,intent:a,label:s,labelActive:o,icon:r,iconActive:c,className:l,onClick:d}){const[u,m]=(0,i.useState)(!1),g=(0,an.W)(),v=t&&o?o:s,h=t&&c?c:r;return(0,p.jsx)(G.f,{style:e,className:l,isActive:t,disabled:n,onToggle:e=>{d?.(),u||e.target.blur(),m(!1),a&&g({type:"click",intent:a,targetUri:""})},onKeyDown:({key:e})=>{"enter"===e.toLowerCase()&&m(!0)},label:v,icon:h,testId:`control-button-${a}`})}var on=n(75610),rn=n(31193),cn=n(909),ln=n(90224);const dn=()=>{const{isAnonymous:e}=(0,o.d4)(Et.Ht),{videoPlayerMode:t}=(0,rn.d)();return e||t===cn.K.cinemaLegacy?{isVisible:!1}:{isVisible:!0,isEnabled:!0}},un=({onClick:e})=>{const{isEnabled:t,isVisible:n}=dn(),a=(0,Yt.zy)(),s=(0,ln.J)(),o=(0,Yt.Zp)(),r=(0,i.useMemo)((()=>"/queue"===a.pathname||"/history"===a.pathname),[a.pathname]),c=(0,i.useCallback)((()=>{const t=s.entries?.slice(0,s.index+1)?.reverse()?.findIndex((({pathname:e})=>"/queue"!==e&&"/history"!==e));e({mode:"main",route:null}),o(-1===t?"/":t>=0?-t:-1)}),[o,s,e]),l=(0,i.useCallback)((()=>{e({mode:"main",route:"/queue"}),o("/queue",{state:{referrer:"now_playing_bar"}})}),[e,o]),d=(0,i.useCallback)((()=>{t&&(r?c():l())}),[t,r,c,l]);return n?(0,p.jsx)(nn,{uri:"spotify:queue",children:(0,p.jsx)(sn,{intent:"queue",icon:Wt.j,label:u.Ru.get("playback-control.queue"),onClick:d,active:r,disabled:!t})}):null},mn=Qe.$S.QUEUE_BUTTON_CLICK,gn=({onClick:e})=>{const{isEnabled:t,isVisible:n}=dn(),a=(0,Ve.Ev)(mn),{isActive:s}=(0,Ve.AI)(qe.Z.Queue,qe.Z.QueueOverlay),{toggleQueue:o}=(0,on.R)(),r=(0,i.useCallback)((()=>{t&&(e({mode:"panel",aboutToShow:!s}),o())}),[t,e,s,o]);return n?(0,p.jsx)(nn,{uri:"spotify:queue",children:(0,p.jsx)(G.f,{icon:Wt.j,label:u.Ru.get("playback-control.queue"),onToggle:r,isActive:s,disabled:!t||!a,testId:"control-button-queue",restoreFocusKey:qe.Z.Queue})}):null},vn=({onClick:e})=>(0,H.NC)(Ot.eWj)?(0,p.jsx)(gn,{onClick:e}):(0,p.jsx)(un,{onClick:e});var pn=n(51100),hn=n(22461),bn=n(92849);const yn=({onClick:e})=>{const{item:t}=(0,hn.L)()??{},{isActive:n,onClick:i,showButton:a}=(0,bn.D)({item:t,onClick:e});return t&&a?(0,p.jsx)(G.f,{isActive:n,onToggle:i,label:n?u.Ru.get("miniplayer.close"):u.Ru.get("miniplayer.open"),icon:pn.F,testId:"pip-toggle-button"}):null};var fn=n(86286),kn=n(8268);const xn="main-nowPlayingBar-extraControls",Cn="main-nowPlayingBar-lyricsButton",Nn="main-nowPlayingBar-volumeBar",jn=()=>{const e=(0,H.NC)(Ot.yux),t=(0,H.NC)(Ot.mzn),{setVideoPlayerUIFlag:n,videoPlayerMode:a}=(0,rn.d)(),{spec:s,logger:o,UBIFragment:r}=(0,j.r)(z.h9,{data:{identifier:a===cn.K.cinemaLegacy?z.gw.CINEMA:z.gw.DESKTOP}}),c=(0,U.YQ)((e=>{o.logInteraction(s.volumeBarFactory().dragSetVolume({newVolumePercentage:Math.floor(100*e)}))}),500,{leading:!1,trailing:!0}),l=(0,i.useCallback)((e=>{e&&n(cn.n.cinemaLegacy,!1)}),[n]);return(0,p.jsx)(r,{spec:s,children:(0,p.jsxs)("div",{className:xn,children:[(0,p.jsx)(kn.mA,{onClick:()=>{o.logInteraction(s.djJumpButtonFactory().hitRefreshContent())}}),(0,p.jsx)(Zt,{onClick:e=>{e?o.logInteraction(s.npvButtonFactory().hitUiReveal()):o.logInteraction(s.npvButtonFactory().hitUiHide())}}),!e&&(0,p.jsx)(Vt,{className:Cn,onClick:e=>{e?o.logInteraction(s.lyricsButtonFactory().hitUiNavigate({destination:e})):o.logInteraction(s.lyricsButtonFactory().hitUiNavigateBack())}}),(0,p.jsx)(vn,{onClick:e=>{"main"===e.mode?e.route?o.logInteraction(s.queueButtonFactory().hitUiNavigate({destination:e.route})):o.logInteraction(s.queueButtonFactory().hitUiNavigateBack()):e.aboutToShow?o.logInteraction(s.queueButtonFactory().hitUiReveal()):o.logInteraction(s.queueButtonFactory().hitUiHide())}}),(0,p.jsx)(Rt,{}),(0,p.jsx)(fn.M,{className:Nn,onVolumeBarClick:e=>{o.logInteraction(s.volumeBarFactory().hitSetVolume({newVolumePercentage:Math.floor(100*e)}))},onToggleMuteClick:e=>{"muted"===e?o.logInteraction(s.volumeMuteButtonFactory().hitMutePlayback()):"not_muted"===e&&o.logInteraction(s.volumeMuteButtonFactory().hitUnmutePlayback())},onVolumeBarDrag:c}),(0,p.jsx)(yn,{onClick:l}),!t&&(0,p.jsx)(X,{className:"control-button",disabledClassName:"control-button--disabled",onClick:e=>{e&&o.logInteraction(s.fullscreenButtonFactory().hitUiReveal())}})]})})};var In=n(59965),Sn=n(35879),wn=n(7307);const An="yyrJTUPMeLS8qs1a0YJr",Tn=({logoUrl:e})=>e?(0,p.jsx)("div",{className:An,"data-testid":"context-ad-logo",children:(0,p.jsx)(Sn.N,{loading:"eager",imgSrc:e,width:56,height:56,type:wn.c.AD})}):null;var Pn=n(39148),En=n(63676),Rn=n(20883);const Dn=({item:e,context:t,index:n})=>{const{logoImage:i}=(0,Pn.b)(e);return(0,p.jsx)(Rn.e,{item:e,context:t,index:n,"aria-label":u.Ru.get("ad-formats.advertisement"),adEventReason:En.c.AD_LOGO,isVisible:!1,children:(0,p.jsx)(Tn,{logoUrl:i})})};var Ln=n(83352),_n=n(24533);const Bn=i.memo((function({uri:e,className:t,onClick:n,size:a=Ln.t.xs}){const[s,o]=(0,_n.A)(e),r=(0,an.W)(),c=(0,i.useCallback)((t=>{t.preventDefault(),r({targetUri:e,intent:s?"remove-from-library":"add-to-library",type:"click"}),n&&n(!s),o(!s)}),[r,e,s,n,o]);return(0,p.jsx)(Ln.M,{className:t,size:a,onClick:c,isAdded:!!s,condensed:!0})}));var On=n(58110),Fn=n(13464),Mn=n(36213);const Un=({uri:e,isBook:t=!1,size:n=Ln.t.xs,className:a,onClick:s})=>{const{isPreSaved:o,addPresave:r,removePresave:c}=(0,Mn.w)({uri:e,isBook:t}),l=(0,i.useCallback)((()=>{o?c():r(),s?.(!o)}),[o,s,c,r]);return(0,p.jsx)(Ln.M,{className:a,size:n,onClick:l,isAdded:!!o,condensed:!0})};var Hn=n(68204),zn=n(31650),Vn=n(93298),Qn=n(24324),qn=n(65462),Kn=n(19341),Gn=n(99977),Zn=n(91127),Yn=n(73395),Wn=n(45627),Xn=n(5805);function $n(e){return(0,Xn.v)(e)||(0,Wn.p)(e)}var Jn=n(27012);const ei="main-nowPlayingWidget-nowPlaying",ti="main-coverSlotCollapsed-navAltContainer",ni="main-nowPlayingWidget-coverArt",ii="main-nowPlayingWidget-trackInfo",ai="HD9s7U5E1RLSWKpXmrqx",si=({onClick:e})=>{const t=(0,hn.L)(),{draggable:n,onDragStart:i}=(0,Jn.P)(),{isActive:a,panelSend:s}=(0,Ve.AI)(qe.Z.NowPlayingView);if(null===t)return null;const{context:o,item:r}=t,c=Qe.$S.NPV_BUTTON_CLICK;return(0,p.jsx)(qn.h,{menu:(0,p.jsx)(Gn.W,{context:o,item:r}),children:(0,p.jsx)("div",{draggable:n&&$n(r),onDragStart:e=>{i(e,{itemUris:[r.uri],dragLabelText:(0,Yn.r)(r)})},children:(0,p.jsx)(Zn.R,{uri:o.uri,owner:o.metadata?.context_owner,children:(0,p.jsx)("button",{type:"button","data-testid":"cover-art-button",className:ai,"aria-label":u.Ru.get("web-player.now-playing-view.label"),onClick:()=>{s(c),e?.(a)},children:(0,p.jsx)(Kn.b,{item:r,size:56,maxSize:56,className:ni})})})})})};var oi=n(42989),ri=n(56602),ci=n(99701);const li="main-coverSlotCollapsed-container",di="main-coverSlotCollapsed-expandButton",ui=Qe.$S.NPV_BUTTON_CLICK,mi=({children:e,className:t})=>{const n=(0,Ve.Ev)(ui),{isActive:a}=(0,Ve.AI)(qe.Z.NowPlayingView),o=(0,Ve._Y)(),r=(0,i.useMemo)((()=>a?{label:u.Ru.get("npb.collapseCoverArt"),Icon:ri.r}:{label:u.Ru.get("npb.expandCoverArt"),Icon:oi.o}),[a]);return(0,p.jsxs)("div",{"data-testid":"CoverSlotCollapsed__container",className:s()(li,t),children:[e,(0,p.jsx)(ci.Zp,{label:r.label,children:(0,p.jsx)("button",{className:s()(di),disabled:!n,onClick:()=>{o(ui)},"aria-label":u.Ru.get("web-player.now-playing-view.label"),"aria-pressed":a,children:(0,p.jsx)(r.Icon,{iconSize:16})})})]})};var gi=n(4041),vi=n(20675),pi=n(50324);var hi=n(16514),bi=n(70521),yi=n(29997),fi=n(75497),ki=n(13947),xi=n(4861),Ci=n(83327);const Ni=({context:e,item:t,onLike:n})=>{const i=(0,yi.X)(),a=(0,zn.v)(t);if(i&&(0,bi.N)(t))return(0,p.jsx)(hi.o,{contextUri:t.metadata?.context_uri??e.uri,id:t.uid??void 0,uri:t.uri,isActive:!0});if(a)return(0,p.jsx)(Hn.g,{uri:t.uri,condensed:!1});if((0,Xn.v)(t))return t.isLocal?null:(0,p.jsx)(Fn.b,{uri:t.uri,className:"control-button control-button-heart",onClick:n});if((0,Wn.p)(t))return(0,p.jsx)(On.b,{uri:t.uri,className:"control-button control-button-heart",onClick:n,condensed:!0});if((0,ki.d)(t)){return"trailer"===t?.metadata?.type&&"true"===t?.metadata?.is_pre_release?(0,p.jsx)(Un,{uri:t.book.uri,isBook:!0,className:"control-button control-button-heart",onClick:n}):(0,p.jsx)(Bn,{uri:t.book.uri,className:"control-button control-button-heart",onClick:n})}return(0,fi.N)(t)||(0,xi.v)(t)?null:(0,kt.d)(t)},ji=({state:{item:e,context:t,index:n}})=>{!function(e){const t=(0,pi.i)(),n=(0,vi.X)(e);(0,i.useEffect)((()=>{n&&t.say(n)}),[n,t])}(e);const{videoPlayerMode:a,setVideoPlayerUIFlag:s}=(0,rn.d)(),{spec:o,logger:r}=(0,j.r)(In.p6,{data:{identifier:a===cn.K.cinemaLegacy?In.gw.CINEMA:In.gw.DESKTOP}}),c=(0,vi.P)(e),l=(0,H.NC)(Ot.WAA);(0,i.useEffect)((()=>{s(cn.n.nowPlayingBar,l)}),[l,s]);const d=a===cn.K.nowPlayingBar&&l;return(0,p.jsx)(i.Suspense,{fallback:null,children:(0,p.jsx)("div",{"data-testid":"now-playing-widget",className:ei,role:"contentinfo","aria-label":c,children:(0,p.jsxs)(Ci.r,{spec:o,children:[(0,fi.N)(e)?(0,p.jsx)(Dn,{item:e,context:t,index:n}):(0,p.jsxs)(mi,{className:ti,children:[!d&&(0,p.jsx)(si,{onClick:t=>{t?r.logInteraction(o.coverartFactory({uri:e.uri}).hitUiReveal()):r.logInteraction(o.coverartFactory({uri:e.uri}).hitUiHide())}}),l&&(0,p.jsx)("div",{id:"VideoPlayerNpb_ReactPortal"})]}),(0,p.jsx)(Vn.d,{context:t,className:ii,item:e,size:"xsmall",enableVideoButton:!0,onTitleClick:t=>{r.logInteraction(o.titleFactory({uri:e.uri}).hitUiNavigate({destination:t||""}))},onSubtitleClick:t=>{r.logInteraction(o.subtitleFactory({uri:e.uri}).hitUiNavigate({destination:t||""}))},referrer:Qn.G.NPB}),(0,p.jsx)(gi.a,{context:t,item:e,onClick:()=>{r.logInteraction(o.hideButtonFactory().hitRemoveRecommendation({recommendedItemUri:e.uri,contextUri:t.uri}))}}),(0,p.jsx)(Ni,{item:e,onLike:t=>{r.logInteraction(t?o.likeButtonFactory({uri:e.uri}).hitLike({itemToBeLiked:e.uri}):o.likeButtonFactory({uri:e.uri}).hitRemoveLike({itemNoLongerLiked:e.uri}))},context:t})]})})})},Ii=()=>{const e=(0,hn.L)();return null===e?(0,p.jsx)("div",{className:s()("now-playing")}):(0,p.jsx)(ji,{state:e})};var Si=n(19870);const wi="aguQsGoZR9wZeawKGdDh",Ai="ieqOSqJb6kk3bG5XDOHk",Ti=({paused:e,fromSeconds:t})=>{const[n,a]=(0,i.useState)(t);return(0,Si.$)((t=>{a((n=>e?n:n>0?n-1:(t(),n)))}),1e3),(0,p.jsxs)("div",{className:wi,children:[u.Ru.get("ad-formats.skippable_ads.skip_countdown"),(0,p.jsx)("span",{className:Ai,children:n})]})};var Pi=n(15987);const Ei=({children:e})=>{const t=(0,Y.o)((e=>e),((e,t)=>(0,L.a)(e?.restrictions,t?.restrictions)&&e?.item?.uri===t?.item?.uri&&e?.isPaused===t?.isPaused)),n=t?.restrictions.disallowSkippingNextReasons.includes("ad_disallow"),i=t?.isPaused??!1,a=(0,Pi.qc)(t),s=(0,Pi.Tv)(t),r=(0,o.d4)((e=>a?e?.ads?.audio?.info?.skippableAdDelaySeconds:s?e?.ads?.vto?.info?.skippableAdDelaySeconds:void 0));return n&&r?(0,p.jsx)(Ti,{paused:!!i,fromSeconds:r}):(0,p.jsx)(p.Fragment,{children:e})};var Ri=n(99623),Di=n(89848);var Li=n(89228),_i=n(33625);const Bi=e=>{const[t,n]=(0,i.useState)(new Map),[a,s]=(0,i.useState)(),o=(0,_i.L)(),r=(0,Di.mr)(),{currentDevice:c}=(0,Li.l)(),l=(0,Be.vh)(),d=(0,i.useCallback)((()=>{if(!e)return;const i=(({lastRecordedItem:e,setLastRecordedItem:t,recentAds:n,setRecentAds:i,playerStateItem:a,currentDevice:s})=>{let o={isMissingAdData:!1};if(a&&a.uri!==e?.uri){if(e?.type===wn.c.AD){const t=e?.uri.split(":")[2];n.has(t)?i((e=>{const n=new Map(e);return n.delete(t),n})):o={isMissingAdData:!0,errorMessage:s.isLocal?"primary_device":"secondary_device",adId:t}}t((()=>a))}return o})({lastRecordedItem:a,setLastRecordedItem:s,recentAds:t,setRecentAds:n,playerStateItem:o?.item,currentDevice:c});if(i.isMissingAdData){const{errorMessage:e,adId:t}=i;l.send((0,Ri.G)({error_type:"missing_ad_data",error_message:e,slot:"stream",ad_id:t}))}}),[o,a,t,l,c,e]),u=(0,i.useCallback)((()=>{e&&r&&n((e=>{let n=e;return t.has(r.adId)||(n=new Map(e).set(r.adId,r)),n}))}),[t,r,e]);(0,i.useEffect)((()=>{d()}),[d]),(0,i.useEffect)((()=>{u()}),[u])};var Oi=n(98676),Fi=n(70200),Mi=n(51642),Ui=n(44119),Hi=n(92699),zi=n(12253),Vi=n(61711),Qi=n(97127),qi=n(62747),Ki=n(83019);const Gi="player-controls",Zi="player-controls__buttons",Yi="player-controls__left",Wi="player-controls__right",Xi=(0,i.memo)((function({item:e}){const t=Ui.Q.isPodcastAd(e),n=Ui.Q.isSurveyAd(e);return(0,p.jsxs)("div",{"data-testid":"ad-controls",className:Zi,children:[(0,p.jsxs)("div",{className:Yi,children:[t&&(0,p.jsx)(Ki.w,{}),(0,p.jsx)(Mi.T,{item:e,isDisabled:n}),t?(0,p.jsx)(zi.h,{}):(0,p.jsx)(Qi.d,{})]}),(0,p.jsx)(Hi.x,{}),(0,p.jsxs)("div",{className:Wi,children:[t?(0,p.jsx)(Vi.v,{}):(0,p.jsx)(Ei,{children:(0,p.jsx)(qi.$,{})}),(0,p.jsx)(Fi.t,{item:e,isDisabled:n})]})]})}));var $i=n(85601),Ji=n(89059),ea=n(11317),ta=n(57187),na=n(25357),ia=n(24620);var aa=n(56507),sa=n(32277);const oa=(0,i.memo)((function({isPreview:e}){const{logChangePlaybackSpeed:t,logChangeRepeatMode:n,logChangeShuffleMode:a,logSeekForward:s,logSeekBack:o,logSkipForward:r,logSkipBack:c,logPlayPause:l,logProgressChanged:d,spec:m}=(()=>{const e=(0,ye.z)(),{videoPlayerMode:t}=(0,rn.d)(),{spec:n,logger:a}=(0,j.r)(ta.kD,{data:{identifier:t===cn.K.cinemaLegacy?ta.gw.CINEMA:ta.gw.DESKTOP}});return{logChangePlaybackSpeed:(0,i.useCallback)((t=>{const i=e.getState();i?.item&&a.logInteraction(n.speedControlButtonFactory().hitSetPlaybackSpeed({currentlyPlayedItem:i.item.uri,playbackSpeed:t}))}),[a,e,n]),logChangeShuffleMode:(0,i.useCallback)((e=>{a.logInteraction(e?n.shuffleButtonFactory().hitShuffleEnable():n.shuffleButtonFactory().hitShuffleDisable())}),[a,n]),logChangeRepeatMode:(0,i.useCallback)((e=>{const t={[na.p.REPEAT_NONE]:n.repeatButtonFactory().hitRepeatDisable(),[na.p.REPEAT_TRACK]:n.repeatButtonFactory().hitRepeatOneEnable(),[na.p.REPEAT_CONTEXT]:n.repeatButtonFactory().hitRepeatEnable()};a.logInteraction(t[e])}),[a,n]),logSeekBack:(0,i.useCallback)((e=>{a.logInteraction(n.seekBackButtonFactory().hitSeekByTime({msSeekedOffset:e}))}),[a,n]),logSeekForward:(0,i.useCallback)((e=>{a.logInteraction(n.seekForwardButtonFactory().hitSeekByTime({msSeekedOffset:e}))}),[a,n]),logSkipBack:(0,i.useCallback)((()=>{const t=e.getState();t&&a.logInteraction(n.previousButtonFactory().hitSkipToPrevious({itemToBeSkipped:t.item?.uri||"",positionMs:(0,ia.s)(t)??-1,totalContentMs:t.duration??-1}))}),[a,e,n]),logSkipForward:(0,i.useCallback)((()=>{const t=e.getState();t?.item&&a.logInteraction(n.nextButtonFactory().hitSkipToNext({itemToBeSkipped:t.item.uri,positionMs:(0,ia.s)(t)??-1,totalContentMs:t.duration??-1}))}),[a,e,n]),logPlayPause:(0,i.useCallback)((t=>{const i=e.getState();i?.item&&("resume"===t?a.logInteraction(n?.playPauseButtonFactory().hitResume({itemToBeResumed:i.item.uri})):"pause"===t&&a.logInteraction(n?.playPauseButtonFactory().hitPause({itemToBePaused:i.item.uri})))}),[a,e,n]),logProgressChanged:(0,i.useCallback)(((e,t)=>{switch(t){case"drag":return a.logInteraction(n.progressBarFactory().dragSeekToTime({msToSeekTo:e}));case"hit":return a.logInteraction(n.progressBarFactory().hitSeekToTime({msToSeekTo:e}));default:return(0,kt.k)(t)}}),[a,n]),spec:n}})();Bi((0,H.NC)(Ot.KYh));const g=(0,Y.o)((e=>e?.item??void 0),((e,t)=>e?.uri===t?.uri)),v=(0,ea.p)();return(0,p.jsx)("div",{className:Gi,"data-testid":"player-controls",dir:"ltr","aria-label":u.Ru.get("playback-control.a11y.landmark-label"),children:(0,p.jsxs)(Ci.r,{spec:m,children:[(0,fi.N)(g)?(0,p.jsx)(Xi,{item:g}):(0,p.jsxs)("div",{className:Zi,"data-testid":"general-controls",children:[(0,p.jsxs)("div",{className:Yi,children:[v?(0,p.jsx)(Ki.w,{onClick:t}):(0,p.jsx)(sa.w,{renderEnabled:()=>(0,p.jsx)(aa.a,{size:"small"}),renderDisabled:()=>(0,p.jsx)(Ji.u,{onClick:a})}),v&&(0,p.jsx)(zi.h,{onClick:o}),(0,p.jsx)(Qi.d,{onClick:c})]}),(0,p.jsx)(Hi.x,{onClick:l}),(0,p.jsxs)("div",{className:Wi,children:[(0,p.jsx)(Ei,{children:(0,p.jsx)(qi.$,{onClick:r})}),v?(0,p.jsx)(Vi.v,{onClick:s}):(0,p.jsx)($i.s,{onClick:n})]})]}),(0,p.jsx)(Oi.x,{isPreview:e,onChange:d})]})})}));var ra=n(44672),ca=n(30147),la=n(50674),da=n(43855);const ua="main-nowPlayingBar-container",ma="main-nowPlayingBar-nowPlayingBar",ga="MWD1i_CSJ5N9wRBDpZmX",va="k3NVrHXkbfflNdAxpT1_",pa="m8UPWsNtWbdkvBNvqgBN",ha="aepuRyT82biv_XmkH1eS",ba="main-nowPlayingBar-left",ya="main-nowPlayingBar-center",fa="main-nowPlayingBar-right",ka="K7b2iysmIbvKo8RqRbc5",xa="adzMqeRxU0__wQcuju5q",Ca=()=>{const{isAnonymous:e}=(0,o.d4)(Et.Ht),t=(0,o.wA)(),n=(0,Y.o)((e=>e),((e,t)=>e?.hasContext===t?.hasContext&&e?.item?.uri===t?.item?.uri)),a=(0,b.h)(),l=(0,Y.o)((e=>(0,fi.N)(e?.item??void 0))),d=(0,i.useCallback)((e=>{e.stopPropagation(),t((0,c.Ai)())}),[t]),u=()=>(0,p.jsx)(ca.ql.Provider,{value:"now_playing_bar",children:(0,p.jsxs)("div",{className:e?ga:ma,children:[(0,p.jsx)("div",{className:ba,children:(0,p.jsx)(Ii,{})}),(0,p.jsx)("div",{className:ya,children:(0,p.jsx)(i.Suspense,{fallback:null,children:(0,p.jsx)(oa,{isPreview:e})})}),(0,p.jsx)("div",{className:fa,children:(0,p.jsx)(jn,{})})]})});return(0,p.jsx)(da.P,{surface:la.u.NOW_PLAYING,children:(0,p.jsx)(ra.pZ,{value:"now-playing-bar",children:(0,p.jsxs)("footer",{className:s()(ua,ka,{[xa]:a}),"data-testid":"now-playing-bar","data-testadtype":"ad-type-"+(l?"ad":"none"),children:[e?(0,p.jsx)(ra.pZ,{value:"preview-bar",children:(0,p.jsx)(h,{handleClick:d})}):null,e?(0,p.jsx)(r.A,{in:n?.hasContext??!1,timeout:200,classNames:{enter:va,enterActive:pa,enterDone:ha},children:u()}):u(),(0,p.jsx)(M,{})]})})})}},76612:(e,t,n)=>{n.d(t,{L:()=>o});var i=n(86660),a=n(89848),s=n(29195);const o=e=>{const t=(0,a.dY)(),n=(0,s.vh)(),o=t.getInStreamAd();return{logAdFeedback:function(t){n.send((0,i.F)({ad_id:e.id,advertiser:e.advertiser,creative_id:o?.adId===e.id?o?.metadata?.creative_id:void 0,format:e.mediaType,line_item_id:o?.adId===e.id?o?.metadata?.lineitem_id:void 0,event:t}))}}}},84859:(e,t,n)=>{n.d(t,{N:()=>o,T:()=>s});var i=n(42551);const a=e=>e.ads.adFeedback,s=(0,i.Mz)([e=>a(e),(e,t)=>t],((e,t)=>!(!t||e.adId!==t)&&e.liked)),o=(0,i.Mz)([e=>a(e),(e,t)=>t],((e,t)=>!(!t||e.adId!==t)&&e.disliked))},74934:(e,t,n)=>{n.d(t,{sY:()=>f,Nh:()=>y,bo:()=>k,r3:()=>b,EX:()=>h,lZ:()=>p});var i=n(14343),a=n(57776);n(59147);const s=new a.l("queryFullscreenMode","query","5aa77fcd9a5b65f829d8dee4000703ff1a7ff68e813c60999c0b2dce754240e2",null);var o=n(38501),r=n(58685),c=n(75497),l=n(13947),d=n(45627),u=n(5805),m=n(4861),g=n(16581),v=n(85907);const p=()=>{const e=(0,i.NC)(o.WYm,{loadingValue:!1});return(0,r.o)(g.A3)||e};function h(e){return(0,u.v)(e)?{uri:e.uri,name:e.name,creatorName:e.artists[0]?.name,coverArtImageUrl:e.images?.[0]?.url,duration:e.duration.milliseconds}:(0,d.p)(e)?{uri:e.uri,name:e.name,creatorName:e.show.name,coverArtImageUrl:e.images?.[0]?.url,duration:e.duration.milliseconds}:(0,l.d)(e)?{uri:e.uri,name:e.name,creatorName:e.book.name,coverArtImageUrl:e.images?.[0]?.url,duration:e.duration.milliseconds}:(0,c.N)(e)?{uri:e.uri,name:e.title??"",creatorName:e.advertiser??"",coverArtImageUrl:e.images?.[0]?.url,duration:e.duration.milliseconds}:(0,m.v)(e)||void 0===e?void 0:(0,v.d)(e)}function b(e){const t=h(e);return(0,u.v)(e)||(0,d.p)(e)||(0,l.d)(e)||(0,c.N)(e)?{...t,duration:e.duration.milliseconds,mediaType:(n=e.mediaType,"video"===n||"mixed"===n?"video":"audio")}:(0,m.v)(e)||void 0===e?void 0:(0,v.d)(e);var n}function y(e){const t=e?.context.metadata?.context_description,n=e?.context.uri||void 0,i=e?.positionAsOfTimestamp??void 0,a=e?.timestamp,s=e?.isPaused,o=e?.restrictions.canPause,r=e?.restrictions.canResume;return{contextName:t,contextUri:n,position:i,timestamp:a,isPaused:s,canPause:o,canResume:r}}async function f(e,t){return e(s,{artistUri:t}).then((e=>{if("Artist"===e?.data?.artistUnion.__typename)return e.data.artistUnion.visuals.headerImage?.sources[0]?.url})).catch((()=>{}))}function k(e,t,n){if(e&&n&&n.hasLyrics)return{status:t?"loading":"success",content:{provider:n.provider,syncType:n.syncType,lines:n.lyrics.map((e=>({timestamp:Number(e.start),text:e.text})))}}}},36213:(e,t,n)=>{n.d(t,{w:()=>d});var i=n(30758),a=n(3117),s=n(31417),o=n(53133),r=n(74008),c=n(48905),l=n(21549);const d=({uri:e,isBook:t})=>{const{add:n,remove:d}=(0,c.p)("prerelease"),u=(0,r.o)("prerelease",[e]).at(0),{enqueueSnackbar:m}=(0,o.d)(),{spec:g,logger:v}=(0,l.r)(a.k,{data:{uri:e}});return{isPreSaved:u,addPresave:(0,i.useCallback)((async()=>{v.logInteraction(g.actionBarFactory().preSaveButtonFactory().hitPresave({prereleaseId:e,itemToBePresaved:e,contextUri:e})),await n(e),m(t?s.Ru.get("web-player.prerelease.audiobook_feedback_presaved"):s.Ru.get("web-player.prerelease.album_feedback_presaved"))}),[n,m,t,v,g,e]),removePresave:(0,i.useCallback)((async()=>{v.logInteraction(g.actionBarFactory().preSaveButtonFactory().hitRemovePresave({prereleaseId:e,itemToBeRemovedFromPresaved:e,contextUri:e})),await d(e)}),[v,d,g,e])}}},50324:(e,t,n)=>{n.d(t,{i:()=>s});var i=n(30758);class a{constructor(e={}){this.settings={level:e.level||"polite",parent:e.parent||document.body,idPrefix:e.idPrefix||"live-region-",delay:e.delay||0},this.currentRegion=document.createElement("span")}say(e,t=this.settings.delay){this.clearNode(),this.currentRegion=document.createElement("span"),this.currentRegion.id=this.settings.idPrefix+Math.floor(1e4*Math.random());const n="assertive"!==this.settings.level?"status":"alert";this.currentRegion.setAttribute("aria-live",this.settings.level),this.currentRegion.setAttribute("role",n),this.currentRegion.setAttribute("style","clip: rect(1px, 1px, 1px, 1px); height: 1px; overflow: hidden; position: absolute; white-space: nowrap; width: 1px"),this.settings.parent.appendChild(this.currentRegion),window.setTimeout((()=>{this.currentRegion.textContent=e}),t)}clearNode(){const e=this.settings.parent.querySelector(`[id^="${this.settings.idPrefix}"]`);e&&this.settings.parent.removeChild(e)}}const s=({delay:e,idPrefix:t,level:n,parent:s}={})=>{const o=(0,i.useMemo)((()=>new a({delay:e,idPrefix:t,level:n,parent:s})),[e,t,n,s]);return(0,i.useEffect)((()=>()=>{o.clearNode()}),[o]),o}},95320:(e,t,n)=>{n.d(t,{v:()=>o});var i=n(7069),a=n(45627),s=n(5805);function o(e){if("string"==typeof e)return(0,i.g)(e);const t=e;return(0,s.v)(t)||(0,a.p)(t)}},89228:(e,t,n)=>{n.d(t,{l:()=>i.l});var i=n(31233)},62197:(e,t,n)=>{n.d(t,{H:()=>a,k:()=>i});const i=18e5,a=6e5},62752:(e,t,n)=>{n.d(t,{I:()=>b});var i=n(50486),a=n(14343),s=n(62197),o=n(1377),r=n(18133),c=n(2254),l=n(21398),d=n(411),u=n(36475);function m(e,t,n){const{startTimeMs:i,words:a}=e,s=n[t+1];return{start:i||0,end:s&&s.startTimeMs?s.startTimeMs:1/0,text:a}}function g(e){return d.Q.fromInt(e).toCSS(u.a.RGB)}var v=n(82935),p=n(43329);const h={hasLyrics:!1},b=(e,t)=>{const n=(0,v.h)(t||void 0,{desiredLabel:"large",desiredSize:600})??t?.[0]?.url??"",d=(0,r.X)(),u=(0,a.NC)(p.Tc,{loadingValue:p.LZ.CONTROL}),b={[p.LZ.CONTROL]:void 0,[p.LZ.SYSTEM_LANGUAGE]:navigator.language,[p.LZ.ALL_LANGUAGES]:"all"}[u],y=["lyrics",{uri:e,image:n,vocalRemoval:d}],{hasLyrics:f,isLoading:k}=(0,o.f)(e),{data:x,isLoading:C,isError:N}=(0,i.I)({queryKey:y,queryFn:async()=>{if(!e||!n)return h;const t=await async function(e,t,n=!1,i){try{const o=await(0,c.S)(e,t,n,i);return{hasLyrics:!0,isTimeSynced:(s=o.lyrics.syncType,"LINE_SYNCED"===s||"SYLLABLE_SYNCED"===s),syncType:o.lyrics.syncType,lyrics:o.lyrics.lines.map(m),colors:(a=o.colors,{text:g(a.text),activeText:g(a.highlightText),background:g(a.background)}),provider:o.lyrics.provider,providerDisplayName:o.lyrics.providerDisplayName,providerLyricsId:o.lyrics.providerLyricsId,hasVocalRemoval:o.hasVocalRemoval??!1,showUpsell:o.lyrics.showUpsell??!1,alternatives:o.lyrics.alternatives}}catch(e){if(e instanceof l.O&&404===e.status)return{hasLyrics:!1};throw e}var a,s}(e,n,d,b);return t},gcTime:s.k,staleTime:s.H,enabled:f}),j=k||C;let I=null;return j||(I=f?x??null:h),{data:I,loading:j,error:N}}},1377:(e,t,n)=>{n.d(t,{f:()=>d});var i=n(50486),a=n(24909),s=n(14343),o=n(22726),r=n(62197),c=n(2254),l=n(38501);const d=e=>{const t=!!e&&(0,o.U_m)(e),n=(0,s.NC)(l.s6w)&&t,{data:d,isLoading:u}=(0,i.I)({queryKey:["useLyricsAvailability",e],queryFn:async()=>!!e&&await(0,c.z)(e),gcTime:r.k,staleTime:r.H,enabled:n,placeholderData:a.rX});return{isLoading:u,hasLyrics:!!n&&(d??!1)}}},18893:(e,t,n)=>{n.d(t,{J:()=>s});var i=n(62752),a=n(58685);const s=()=>{const e=(0,a.o)((e=>e?.item),((e,t)=>e?.uri===t?.uri));return(0,i.I)(e?.uri,e?.images)}},18133:(e,t,n)=>{n.d(t,{X:()=>o});var i=n(14343),a=n(38501),s=n(77153);const o=()=>{const e=(0,s.S)(),{isSupported:t}=e.getCapabilities();return(0,i.NC)(a.OBX,{loadingValue:!1})&&t}},28874:(e,t,n)=>{n.d(t,{s:()=>a,u:()=>i});const i=e=>e.ui.lyrics.mode,a=e=>e.ui.lyrics.translationLanguage},2254:(e,t,n)=>{n.d(t,{S:()=>o,z:()=>r});var i=n(22726),a=n(1599),s=n(72671);const o=async(e,t,n,o)=>{const r=(0,i.o_h)(e).id,c=a.n.getInstance(),l={format:"json",vocalRemoval:n};o&&(l.clientLanguage=o);return(await c.build().withHost(s.Hj).withPath(`/track/${encodeURIComponent(r)}/image/${encodeURIComponent(t)}`).withQueryParameters(l).withEndpointIdentifier("/track/{trackId}").send()).body},r=async e=>{const t=(0,i.Y8v)((0,i.o_h)(e)?.id);if(!t)return!1;const n=a.n.getInstance(),o=await n.build().withHost(s.XE).withPath(`/track/${encodeURIComponent(t)}`).withEndpointIdentifier("/track/{trackId}").send();return o.body?.has_lyrics||!1}},66204:(e,t,n)=>{n.d(t,{A:()=>r});var i=n(85387),a=n(90841),s=n(31193),o=n(909);function r({referrer:e,onChange:t}){const n=(0,i.Zp)(),{isActive:r,routeDestination:c}=(0,a.$)(),{setVideoPlayerUIFlag:l}=(0,s.d)(),d=()=>{r||(l(o.n.cinemaLegacy,!1),n(c,{state:{referrer:e}}),t?.(c))},u=()=>{r&&(n(-1),t?.(null))};return{isActive:r,showLyrics:d,hideLyrics:u,toggleLyrics:()=>{r?u():d()}}}},11317:(e,t,n)=>{n.d(t,{p:()=>r});var i=n(58685),a=n(75497),s=n(13947),o=n(45627);function r(){const e=(0,i.o)((e=>e?.item??void 0),((e,t)=>e?.uri===t?.uri));return(0,o.p)(e)||(0,s.d)(e)?"audio"===e.mediaType||"mixed"===e.mediaType:!!(0,a.N)(e)&&e.isPodcastAd}},29997:(e,t,n)=>{n.d(t,{X:()=>i.X});var i=n(41364)},19870:(e,t,n)=>{n.d(t,{$:()=>a});var i=n(30758);const a=(e,t)=>{const n=(0,i.useRef)(e);(0,i.useEffect)((()=>{n.current=e}),[e]),(0,i.useEffect)((()=>{let e;function i(){e&&clearInterval(e)}if(null!==t)return e=setInterval((function(){n.current(i)}),t),i}),[t])}},25182:(e,t,n)=>{n.d(t,{f:()=>r});var i=n(30758),a=n(73075),s=n.n(a);const o=new Map;function r(e,t){const n=function(e){const t=o.get(e.toString());if(t)return t;const n=[];return s().bind(e,(()=>n.forEach((e=>e())))),o.set(e.toString(),n),n}(e);(0,i.useEffect)((()=>(n.push(t),()=>{n.splice(n.indexOf(t),1)})),[n,t])}},92849:(e,t,n)=>{n.d(t,{D:()=>d});var i=n(30758),a=n(86996);var s=n(31193),o=n(909),r=n(89402),c=n(29634),l=n(21549);const d=({item:e,onClick:t})=>{const n=(0,r.W)(),{capabilities:{isEnabled:d},isOpen:u,close:m,open:g,canOpen:v}=(0,c.H)(),{videoPlayerMode:p}=(0,s.d)(),{spec:h,logger:b}=(0,l.r)(a.h9,{data:{identifier:p===o.K.cinemaLegacy?a.gw.CINEMA:a.gw.DESKTOP}}),y=(0,i.useCallback)((()=>{let i;d&&(u?(m(),e?.uri&&b.logInteraction(h.pipButtonFactory({uri:e.uri}).hitUiHide()),i="close-picture-in-picture"):(g(),e?.uri&&(({spec:e,logger:t,uri:n})=>{const i=window.documentPictureInPicture;if(!i)return;const a=s=>{setTimeout((()=>{const i=s.window?.innerWidth,a=s.window?.innerHeight;if(!i||!a)return;const o=e.pipButtonFactory({uri:n}).hitUiOpenWindow({widthPx:i,heightPx:a});t.logInteraction(o)}),100),i.removeEventListener("enter",a)};i.addEventListener("enter",a)})({spec:h,logger:b,uri:e.uri}),i="show-picture-in-picture"),t?.(!u,e?.uri),n({type:"click",intent:i,targetUri:e?.uri,itemIdSuffix:"picture-in-picture-toggle"}))}),[m,d,u,e?.uri,b,t,n,g,h]);return{showButton:v,isActive:u,onClick:y}}},60384:(e,t,n)=>{n.d(t,{I:()=>l});var i=n(30758),a=n(1599),s=n(72671);var o=n(87182),r=n(29074),c=n(2679);const l=({uri:e,setFeedbackPath:t,removeFeedbackPath:n,contextUri:l})=>{const d=(0,o.z)(),u=(0,r.m)(),{isPlaying:m}=(0,c.te)(e),g=(0,i.useCallback)((()=>{l&&u.resync(l)}),[l,u]);return{setDislikeFeedback:(0,i.useCallback)((async()=>{t&&(await((e,t,n)=>{const i=t.replace("<reason>","LOCAL_NOT_APPROPRIATE_FOR_CONTEXT").replace("<track-uri>",n);return e.build().withMethod("POST").withHost(s.L1).withPath(i).withEndpointIdentifier("/<feature>/feedback/").send()})(a.n.getInstance(),t,e),g(),m&&d.skipToNext())}),[t,e,g,m,d]),removeDislikeFeedback:(0,i.useCallback)((async()=>{n&&(await((e,t,n)=>{const i=t.replace("<reason>","LOCAL_NOT_APPROPRIATE_FOR_CONTEXT").replace("<track-uri>",n);return e.build().withMethod("DELETE").withHost(s.L1).withPath(i).withEndpointIdentifier("/<feature>/feedback/").send()})(a.n.getInstance(),n,e),g())}),[n,g,e])}}},43855:(e,t,n)=>{n.d(t,{P:()=>i.P});var i=n(62361)}}]);
//# sourceMappingURL=dwp-now-playing-bar.js.map